# üß™ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É —Ç–µ—Å—Ç–æ–≤ Antenna Module

## ‚úÖ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã

```
tests/antenna/
‚îú‚îÄ‚îÄ CMakeLists.txt           ‚Üí antenna-tests-CMakeLists.txt
‚îî‚îÄ‚îÄ test_antenna_module.cpp  ‚Üí test_antenna_module.cpp
```

---

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### –¢–µ—Å—Ç 1: CPU -> SVM -> GPU (Zero-Copy)
**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –Ω–∞ CPU
2. –°–æ–∑–¥–∞–Ω–∏–µ SVM –±—É—Ñ–µ—Ä–∞ (Shared Virtual Memory)
3. –ü—Ä—è–º–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ SVM (zero-copy –¥–æ—Å—Ç—É–ø)
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ FFT –Ω–∞ GPU —á–µ—Ä–µ–∑ `ProcessNew(svm_buffer)`
5. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ù—É–ª–µ–≤–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É CPU –∏ GPU!

### –¢–µ—Å—Ç 2: CPU -> External OpenCL -> Import to DrvGPU -> GPU
**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –Ω–∞ CPU
2. –°–æ–∑–¥–∞–Ω–∏–µ **–≤–Ω–µ—à–Ω–µ–≥–æ** OpenCL –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ `cl_mem` –±—É—Ñ–µ—Ä–∞
3. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤–Ω–µ—à–Ω–∏–π –±—É—Ñ–µ—Ä
4. **–í–∞—Ä–∏–∞–Ω—Ç A:** –ü–µ—Ä–µ–¥–∞—á–∞ `cl_mem` –Ω–∞–ø—Ä—è–º—É—é –≤ `ProcessNew(cl_mem)`
5. **–í–∞—Ä–∏–∞–Ω—Ç B:** –ò–º–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ `GPUBuffer` wrapper –∏ `clEnqueueCopyBuffer`
6. –û–±—Ä–∞–±–æ—Ç–∫–∞ FFT –Ω–∞ GPU
7. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º OpenCL –∫–æ–¥–æ–º!

---

## üî¢ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–≥–Ω–∞–ª–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```cpp
NUM_BEAMS = 10              // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–Ω—Ç–µ–Ω–Ω (–ª—É—á–µ–π)
POINTS_PER_BEAM = 1500      // –¢–æ—á–µ–∫ –Ω–∞ –ª—É—á
FFT_EXPAND_FACTOR = 2       // –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ FFT (nFFT = 2 * NextPowerOf2(1500))
OUT_COUNT_FFT = 1000        // –¢–æ—á–µ–∫ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
MAX_PEAKS = 3               // –ü–∏–∫–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞
```

### –§–æ—Ä–º—É–ª–∞ —Å–∏–≥–Ω–∞–ª–∞:
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª—É—á–∞ `i` (i = 0..9):

**–ß–∞—Å—Ç–æ—Ç–∞:**
```
w_i = w0 * (1.5^i)
–≥–¥–µ w0 = POINTS_PER_BEAM / 3 = 1500 / 3 = 500
```

**–§–∞–∑–∞:**
```
phi_i = i * 5¬∞ = i * (œÄ/36) —Ä–∞–¥–∏–∞–Ω
```

**–°–∏–≥–Ω–∞–ª:**
```
signal[i][t] = exp(j * (2œÄ * t * w_i / POINTS_PER_BEAM + phi_i))
             = cos(angle) + j * sin(angle)

–≥–¥–µ angle = 2œÄ * t * w_i / POINTS_PER_BEAM + phi_i
```

### –ü—Ä–∏–º–µ—Ä —á–∞—Å—Ç–æ—Ç –ø–æ –ª—É—á–∞–º:

| –õ—É—á | –ß–∞—Å—Ç–æ—Ç–∞ w_i | –ú–Ω–æ–∂–∏—Ç–µ–ª—å | –§–∞–∑–∞ œÜ_i (¬∞) |
|-----|-------------|-----------|--------------|
| 0   | 500.00      | 1.5^0     | 0¬∞           |
| 1   | 750.00      | 1.5^1     | 5¬∞           |
| 2   | 1125.00     | 1.5^2     | 10¬∞          |
| 3   | 1687.50     | 1.5^3     | 15¬∞          |
| 4   | 2531.25     | 1.5^4     | 20¬∞          |
| 5   | 3796.88     | 1.5^5     | 25¬∞          |
| 6   | 5695.31     | 1.5^6     | 30¬∞          |
| 7   | 8542.97     | 1.5^7     | 35¬∞          |
| 8   | 12814.45    | 1.5^8     | 40¬∞          |
| 9   | 19221.68    | 1.5^9     | 45¬∞          |

---

## üîß –ö–æ–º–ø–∏–ª—è—Ü–∏—è

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π CMakeLists.txt

```cmake
# –í —Å–µ–∫—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
if(BUILD_TESTS)
    add_subdirectory(tests/antenna)
endif()
```

### –®–∞–≥ 2: –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

```bash
cd build
cmake .. -DBUILD_TESTS=ON
make test_antenna_module
```

---

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
cd build
./bin/test_antenna_module
```

### –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë          –¢–ï–°–¢–´ ANTENNA FFT MODULE                             ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë –¢–ï–°–¢ 1: CPU -> SVM -> GPU (Zero-Copy)                        ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

‚ïê‚ïê‚ïê –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è DrvGPU ‚ïê‚ïê‚ïê
‚úÖ DrvGPU –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

‚ïê‚ïê‚ïê –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Antenna –º–æ–¥—É–ª—è ‚ïê‚ïê‚ïê
  –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - –õ—É—á–µ–π: 10
    - –¢–æ—á–µ–∫/–ª—É—á: 1500
    - FFT expand: 2x
    - Out FFT: 1000
    - Max peaks: 3

‚úÖ Antenna –º–æ–¥—É–ª—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
   nFFT –≤—ã—á–∏—Å–ª–µ–Ω: 4096

‚ïê‚ïê‚ïê –®–∞–≥ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –Ω–∞ CPU ‚ïê‚ïê‚ïê
  –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞:
    - –ë–∞–∑–æ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞ w0: 500.00 –æ—Ç—Å—á—ë—Ç–æ–≤
    - –°–¥–≤–∏–≥ —Ñ–∞–∑—ã: 5¬∞ (0.087 —Ä–∞–¥)

    –õ—É—á 0: w=500.00, œÜ=0.00¬∞
    –õ—É—á 1: w=750.00, œÜ=5.00¬∞
    –õ—É—á 2: w=1125.00, œÜ=10.00¬∞
    ...

‚úÖ –°–∏–≥–Ω–∞–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω: 15000 –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö —Ç–æ—á–µ–∫

‚ïê‚ïê‚ïê –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ SVM –±—É—Ñ–µ—Ä–∞ (Zero-Copy) ‚ïê‚ïê‚ïê
‚úÖ SVM –±—É—Ñ–µ—Ä —Å–æ–∑–¥–∞–Ω: 15000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤

‚ïê‚ïê‚ïê –®–∞–≥ 5: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ SVM ‚ïê‚ïê‚ïê
‚úÖ –î–∞–Ω–Ω—ã–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ø–∞–º—è—Ç–∏
   (Zero-Copy: –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –Ω–∞ CPU, –∏ –Ω–∞ GPU!)

‚ïê‚ïê‚ïê –®–∞–≥ 6: –û–±—Ä–∞–±–æ—Ç–∫–∞ FFT –Ω–∞ GPU (ProcessNew) ‚ïê‚ïê‚ïê

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  AntennaModule::ProcessNew() - Automatic Strategy Selection
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
 ‚îÇ MEMORY CHECK                                                ‚îÇ
 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
 ‚îÇ GPU Global Memory ‚îÇ       8192 MB ‚îÇ
 ‚îÇ Threshold (65%)   ‚îÇ       5324 MB ‚îÇ
 ‚îÇ Required Memory   ‚îÇ         32 MB ‚îÇ
 ‚îÇ Status            ‚îÇ       OK ‚úÖ   ‚îÇ

  ‚úÖ STRATEGY: SINGLE-BATCH (full processing)
  All beams will be processed in one pass.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  ProcessNew() complete ‚úÖ
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

‚úÖ FFT –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

‚ïê‚ïê‚ïê –®–∞–≥ 7: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚ïê‚ïê‚ïê

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –†–ï–ó–£–õ–¨–¢–ê–¢–´ FFT –û–ë–†–ê–ë–û–¢–ö–ò                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

  nFFT –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π: 4096
  –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –ª—É—á–µ–π: 10

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –õ—É—á   ‚îÇ Peak #  ‚îÇ   Amplitude    ‚îÇ  Phase (¬∞)  ‚îÇ     Index      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ      0 ‚îÇ       1 ‚îÇ       750.5432 ‚îÇ       0.00  ‚îÇ            122 ‚îÇ
‚îÇ        ‚îÇ       2 ‚îÇ       245.1234 ‚îÇ      45.23  ‚îÇ            245 ‚îÇ
‚îÇ        ‚îÇ       3 ‚îÇ       123.4567 ‚îÇ     -23.45  ‚îÇ            367 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ      1 ‚îÇ       1 ‚îÇ       823.9876 ‚îÇ       5.00  ‚îÇ            183 ‚îÇ
‚îÇ        ‚îÇ       2 ‚îÇ       267.3456 ‚îÇ      52.11  ‚îÇ            366 ‚îÇ
‚îÇ        ‚îÇ       3 ‚îÇ       134.5678 ‚îÇ     -18.34  ‚îÇ            549 ‚îÇ
...
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë –¢–ï–°–¢ 1 –ó–ê–í–ï–†–®–Å–ù –£–°–ü–ï–®–ù–û ‚úÖ                                    ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù


‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë –¢–ï–°–¢ 2: CPU -> External OpenCL -> Import to DrvGPU -> GPU    ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

...
```

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

1. **–ö–∞–∂–¥—ã–π –ª—É—á –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –ø–∏–∫ –Ω–∞ —Å–≤–æ–µ–π —á–∞—Å—Ç–æ—Ç–µ**
   - –õ—É—á 0 ‚Üí –ø–∏–∫ –æ–∫–æ–ª–æ –∏–Ω–¥–µ–∫—Å–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —á–∞—Å—Ç–æ—Ç–µ 500 Hz
   - –õ—É—á 1 ‚Üí –ø–∏–∫ –æ–∫–æ–ª–æ –∏–Ω–¥–µ–∫—Å–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —á–∞—Å—Ç–æ—Ç–µ 750 Hz
   - –ò —Ç.–¥.

2. **–§–∞–∑—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è –Ω–∞ 5¬∞ –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ –ª—É—á–∞–º–∏**

3. **–ê–º–ø–ª–∏—Ç—É–¥—ã –º–∞–∫—Å–∏–º—É–º–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º–∏** (>100)

4. **–û–±–∞ —Ç–µ—Å—Ç–∞ –¥–æ–ª–∂–Ω—ã –¥–∞—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
   - –¢–µ—Å—Ç 1 (SVM) –∏ –¢–µ—Å—Ç 2 (External OpenCL) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ —á–∞—Å—Ç–∏ `antenna_module.cpp` –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã:
   ```bash
   cat antenna_module-part1.cpp antenna_module-part2.cpp \
       antenna_module-part3.cpp antenna_module-part4.cpp \
       > modules/antenna/src/antenna_module.cpp
   ```

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ kernels —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã:
   ```bash
   ls build/modules/antenna/kernels/antenna_fft.cl
   ```

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   ldconfig -p | grep clFFT
   ```

### –ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å OpenCL —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:
   ```bash
   clinfo
   ```

2. –£–≤–µ–ª–∏—á–∏—Ç—å –ª–æ–≥ —É—Ä–æ–≤–µ–Ω—å:
   ```cpp
   // –í –Ω–∞—á–∞–ª–µ main()
   drv_gpu_lib::Logger::SetLogLevel(drv_gpu_lib::LogLevel::DEBUG);
   ```

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏ GPU:
   ```cpp
   // –£–º–µ–Ω—å—à–∏—Ç—å NUM_BEAMS –∏–ª–∏ POINTS_PER_BEAM
   const size_t NUM_BEAMS = 5;
   const size_t POINTS_PER_BEAM = 1000;
   ```

---

## ‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (Multi-Batch):

```cpp
const size_t NUM_BEAMS = 100;        // –ú–Ω–æ–≥–æ –ª—É—á–µ–π
const size_t POINTS_PER_BEAM = 10000; // –ú–Ω–æ–≥–æ —Ç–æ—á–µ–∫
```

–û–∂–∏–¥–∞–µ—Ç—Å—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ **MULTI-BATCH** —Ä–µ–∂–∏–º:
```
‚ö†Ô∏è  STRATEGY: MULTI-BATCH (batch processing)
  Beams will be split into batches.

  Batch Configuration:
    - Total beams: 100
    - Batch size: 22 (22.0%)
    - Estimated batches: 5

  Processing batch 1/5 (beams 0-21)...
  Processing batch 2/5 (beams 22-43)...
  ...
```

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤:

1. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Antenna –º–æ–¥—É–ª—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç
2. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å `reduction_kernel` –¥–ª—è production
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–±–æ–ª–∏—á–µ—Å–∫—É—é –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—é –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

**–¢–µ—Å—Ç—ã –≥–æ—Ç–æ–≤—ã –∫ –∑–∞–ø—É—Å–∫—É!** üöÄ
