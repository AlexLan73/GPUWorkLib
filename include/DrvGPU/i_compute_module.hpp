#pragma once

/**
 * @file i_compute_module.hpp
 * @brief Абстрактный интерфейс для compute модулей
 * 
 * IComputeModule - базовый интерфейс для всех вычислительных модулей
 * (FFT, Matrix, Convolution, etc.)
 * 
 * @author DrvGPU Team
 * @date 2026-01-31
 */

#include <string>
#include <memory>

namespace drv_gpu_lib {

// Forward declaration
class IBackend;

// ════════════════════════════════════════════════════════════════════════════
// Interface: IComputeModule - базовый интерфейс для модулей
// ════════════════════════════════════════════════════════════════════════════

/**
 * @interface IComputeModule
 * @brief Абстрактный интерфейс для compute модулей
 * 
 * Каждый compute модуль реализует этот интерфейс, предоставляя
 * единообразный способ инициализации и выполнения.
 * 
 * Примеры модулей:
 * - FFTModule (быстрое преобразование Фурье)
 * - MatrixModule (умножение матриц, транспонирование)
 * - ConvolutionModule (свёртка)
 * - SortModule (сортировка на GPU)
 * 
 * Жизненный цикл модуля:
 * 1. Создание (конструктор)
 * 2. Initialize() - компиляция kernels, подготовка
 * 3. Execute() - выполнение вычислений (многократно)
 * 4. Cleanup() - освобождение ресурсов
 * 5. Деструктор
 * 
 * Паттерн: Template Method (определяет скелет алгоритма)
 */
class IComputeModule {
public:
    virtual ~IComputeModule() = default;
    
    // ═══════════════════════════════════════════════════════════════
    // Жизненный цикл
    // ═══════════════════════════════════════════════════════════════
    
    /**
     * @brief Инициализировать модуль
     * Компилирует kernels, выделяет ресурсы, готовит модуль к работе
     * @throws std::runtime_error при ошибке инициализации
     */
    virtual void Initialize() = 0;
    
    /**
     * @brief Проверить, инициализирован ли модуль
     */
    virtual bool IsInitialized() const = 0;
    
    /**
     * @brief Очистить ресурсы модуля
     */
    virtual void Cleanup() = 0;
    
    // ═══════════════════════════════════════════════════════════════
    // Информация о модуле
    // ═══════════════════════════════════════════════════════════════
    
    /**
     * @brief Получить имя модуля
     */
    virtual std::string GetName() const = 0;
    
    /**
     * @brief Получить версию модуля
     */
    virtual std::string GetVersion() const = 0;
    
    /**
     * @brief Получить описание модуля
     */
    virtual std::string GetDescription() const = 0;
    
    // ═══════════════════════════════════════════════════════════════
    // Доступ к бэкенду
    // ═══════════════════════════════════════════════════════════════
    
    /**
     * @brief Получить бэкенд, с которым работает модуль
     */
    virtual IBackend* GetBackend() const = 0;
};

} // namespace DrvGPU
