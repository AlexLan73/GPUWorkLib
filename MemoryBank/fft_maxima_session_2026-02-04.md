# FFT Maxima Module - Session 2026-02-04

## ğŸ¯ Ğ§Ñ‚Ğ¾ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ

### Ğ ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¿Ğ¾ SOLID (3355 ÑÑ‚Ñ€Ğ¾Ğº â†’ Ñ‡Ğ¸ÑÑ‚Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°)

| Ğ¤Ğ°Ğ¹Ğ» | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ¡Ñ‚Ñ€Ğ¾Ğº | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ |
|------|----------|-------|--------|
| `antenna_fft_core.h/cpp` | Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ğ°Ğ±ÑÑ‚Ñ€Ğ°ĞºÑ‚Ğ½Ñ‹Ğ¹ ĞºĞ»Ğ°ÑÑ Ñ Ğ¾Ğ±Ñ‰Ğ¸Ğ¼ Ñ†Ğ¸ĞºĞ»Ğ¾Ğ¼ batching | ~650 | âœ… |
| `antenna_fft_release.h/cpp` | Release Ğ²ĞµÑ€ÑĞ¸Ñ (clFFT callbacks) - PRODUCTION | ~400 | âœ… |
| `antenna_fft_debug.h/cpp` | Debug Ğ²ĞµÑ€ÑĞ¸Ñ (step-by-step kernels) - TESTING | ~850 | âœ… |
| `fft_logger.h` | Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ!) | ~100 | âœ… |
| `fft_result_writer.hpp` | Ğ’Ñ‹Ğ²Ğ¾Ğ´ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² (MD + JSON) | ~285 | âœ… |
| `antenna_fft_params.h` | Ğ¢Ğ¸Ğ¿Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (FFTResult, FFTMaxResult, etc) | ~130 | âœ… |
| `fft_kernel_sources.hpp` | GPU kernels (padding, post, callbacks) | ~300 | âœ… |
| `CMakeLists.txt` | Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ | ~225 | âœ… |
| `test_fft_maxima.cpp` | Ğ¢ĞµÑÑ‚Ñ‹ (Release, Debug, Compare) | ~330 | âœ… |

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ĞºĞ»Ğ°ÑÑĞ¾Ğ²

```
              AntennaFFTCore (abstract)
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ ProcessNew()            â”‚ â† Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ°
              â”‚ ProcessWithBatching()   â”‚ â† ĞĞ‘Ğ©Ğ˜Ğ™ Ñ†Ğ¸ĞºĞ» (virtual ProcessBatch)
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–²
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AntennaFFTProcMaxâ”‚          â”‚   AntennaFFTDebug     â”‚
â”‚   (RELEASE)      â”‚          â”‚    (DEBUG/TEST)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ProcessBatch()   â”‚          â”‚ ProcessBatch()        â”‚
â”‚ â†’ callbacks      â”‚          â”‚ â†’ step-by-step        â”‚
â”‚   (1 Ğ²Ñ‹Ğ·Ğ¾Ğ² FFT)  â”‚          â”‚                       â”‚
â”‚                  â”‚          â”‚ ExecutePaddingKernel()â”‚
â”‚                  â”‚          â”‚ ExecuteFFTOnly()      â”‚
â”‚                  â”‚          â”‚ ExecutePostKernel()   â”‚
â”‚                  â”‚          â”‚ FindMaximaOnGPU()     â”‚
â”‚                  â”‚          â”‚ ReadFFTInputBuffer()  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ£Ğ´Ğ°Ğ»Ñ‘Ğ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹
- `antenna_fft_proc_max.cpp` (3355 ÑÑ‚Ñ€Ğ¾Ğº) - Ğ·Ğ°Ğ¼ĞµĞ½Ñ‘Ğ½ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ¾Ğ¹
- `antenna_fft_proc_max.h` - Ğ·Ğ°Ğ¼ĞµĞ½Ñ‘Ğ½ Ğ½Ğ¾Ğ²Ñ‹Ğ¼Ğ¸ headers
- `antenna_fft_proc_max1.cpp` - ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½ Ñ€Ğ°Ğ½ĞµĞµ (parallel Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹)

---

## ğŸ”´ Ğ§Ñ‚Ğ¾ Ğ¾ÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ²Ñ‚Ñ€Ğ°

### Ğ’Ñ‹ÑĞ¾ĞºĞ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚
1. **ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ** - Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ÑÑ (cmake + build)
2. **Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸** - Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ `drv_gpu_common`, `drv_gpu_opencl`, `clFFT`
3. **Ğ¢ĞµÑÑ‚** - Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ `test_fft_maxima` Ğ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹

### Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚
4. **Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ** - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ Ğ² Ğ³Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ CMakeLists.txt GPUWorkLib
5. **ĞÑ‚Ğ»Ğ°Ğ´ĞºĞ°** - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ `AntennaFFTDebug` Ğ´Ğ»Ñ Ğ¿Ğ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°

### ĞĞ¸Ğ·ĞºĞ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚
6. **Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ** - Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ MemoryBank Ñ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°Ğ¼Ğ¸ Ñ‚ĞµÑÑ‚Ğ¾Ğ²

---

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ

```
ğŸ“ fft_maxima/
â”œâ”€â”€ ğŸ“„ CMakeLists.txt
â”œâ”€â”€ ğŸ“ include/
â”‚   â”œâ”€â”€ ğŸ“„ antenna_fft_core.h
â”‚   â”œâ”€â”€ ğŸ“„ antenna_fft_release.h
â”‚   â”œâ”€â”€ ğŸ“„ antenna_fft_debug.h
â”‚   â”œâ”€â”€ ğŸ“„ fft_logger.h
â”‚   â”œâ”€â”€ ğŸ“„ fft_result_writer.hpp
â”‚   â”œâ”€â”€ ğŸ“ interface/
â”‚   â”‚   â””â”€â”€ ğŸ“„ antenna_fft_params.h
â”‚   â””â”€â”€ ğŸ“ kernels/
â”‚       â””â”€â”€ ğŸ“„ fft_kernel_sources.hpp
â”œâ”€â”€ ğŸ“ src/
â”‚   â”œâ”€â”€ ğŸ“„ antenna_fft_core.cpp
â”‚   â”œâ”€â”€ ğŸ“„ antenna_fft_release.cpp
â”‚   â””â”€â”€ ğŸ“„ antenna_fft_debug.cpp
â””â”€â”€ ğŸ“ tests/
    â””â”€â”€ ğŸ“„ test_fft_maxima.cpp
```

---

## ğŸ’¡ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸

### Release (AntennaFFTProcMax)
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ clFFT callbacks (pre + post)
- ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
- ĞĞ´Ğ¸Ğ½ Ğ²Ñ‹Ğ·Ğ¾Ğ² FFT Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ğ²ÑÑ‘: padding â†’ FFT â†’ magnitude â†’ select

### Debug (AntennaFFTDebug)
- ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ğ¾Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ kernels
- ĞœĞ¾Ğ¶Ğ½Ğ¾ Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ¼ĞµĞ¶ÑƒÑ‚Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ±ÑƒÑ„ĞµÑ€Ñ‹ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸
- `ExecutePaddingKernel()` â†’ `ExecuteFFTOnly()` â†’ `ExecutePostKernel()` â†’ `FindMaximaOnGPU()`

### ĞĞ±Ñ‰Ğ¸Ğ¹ Ñ†Ğ¸ĞºĞ» batching
- Ğ’ `AntennaFFTCore::ProcessWithBatching()` - ĞĞ”Ğ˜Ğ Ğ ĞĞ— Ğ½Ğ°Ğ¿Ğ¸ÑĞ°Ğ½
- Virtual `ProcessBatch()` - Ñ€ĞµĞ°Ğ»Ğ¸Ğ·ÑƒĞµÑ‚ÑÑ Ğ² Ğ½Ğ°ÑĞ»ĞµĞ´Ğ½Ğ¸ĞºĞ°Ñ…

### Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
```cpp
// ĞÑ‚ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸:
FFTLogger::SetEnabled(false);

// Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸:
FFTLogger::SetLevel(FFTLogger::Level::Error);
```

---

## ğŸ“ Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ¸ Ğ´Ğ»Ñ Ğ·Ğ°Ğ²Ñ‚Ñ€Ğ°

1. ĞŸÑ€Ğ¸ ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ include paths Ğ´Ğ»Ñ `common/i_backend.hpp`
2. clFFT Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½ Ñ‡ĞµÑ€ĞµĞ· `find_package(clFFT CONFIG REQUIRED)`
3. Ğ¢ĞµÑÑ‚ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ ÑĞ¸Ğ³Ğ½Ğ°Ğ» Ñ Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ğ¼Ğ¸ Ñ‡Ğ°ÑÑ‚Ğ¾Ñ‚Ğ°Ğ¼Ğ¸ - Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ğ¼Ğ°ĞºÑĞ¸Ğ¼ÑƒĞ¼Ñ‹ Ğ½Ğ° Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¸Ğ½Ğ´ĞµĞºÑĞ°Ñ…
4. Ğ•ÑĞ»Ğ¸ callbacks Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Debug Ğ²ĞµÑ€ÑĞ¸Ñ Ğ´Ğ»Ñ Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ¸

---

*Ğ¡ĞµÑÑĞ¸Ñ: 2026-02-04*
*Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: Ğ ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½, Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğº Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ*
